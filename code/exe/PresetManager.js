// MINIFIED VERSION OF THE FILE OF THE SAME NAME IN THE `src` FOLDER
// MINIFIED WITH https://www.toptal.com/developers/javascript-minifier 

export class Loader{constructor(){this.activeList=[],this.compressor=new URIManager}async load(){this.activeList=this.compressor.pull().split(","),console.debug(this);var e=window.audioNodes;for(var r of e)if(this.activeList.some(e=>e.startsWith(r.src))){await r.play();var t=this.activeList.find(e=>e.startsWith(r.src));for(var a of(await r.adjustVolume(t.split(";")[1]),r.elements))a.querySelectorAll(".SLIDER")[0].value=100*Math.cbrt(parseFloat(t.split(";")[1])/2)}}}export class Saver{constructor(){this.activeList=[],this.compressor=new URIManager,this.oldDigest=""}async save(){this.activeList=[];var e=window.audioNodes;for(var r of e)r.playing&&this.activeList.push(r.src+";"+r.volume);var t=this.activeList.join(",");let a=new TextEncoder;var s=await crypto.subtle.digest("SHA-256",a.encode(t));s!=this.oldDigest&&(this.compressor.push(t),this.oldDigest=s,console.debug(this))}}export class URIManager{constructor(){this.maxURILength=8192,this.defaultCompression="LZMA2",this.defaultEncoding="URI-B64",this.lastAlert=new Date(0)}alertNoSpam(){new Date().getTime()-this.lastAlert>=3e4&&alert("Maxium URL Length Reached!\n\nShorten your document or prepare to save the raw text content!"),this.lastAlert=new Date().getTime()}pull(e){var r=this.getURL(e),t=r.data;if(window.location.href.endsWith("program.html.php")||window.location.href.endsWith("program.html"))return"";if(""==t)return"Error\n	No data parameter provided";var a=r.compressor,s=r.encoding;try{t=this.decode(t,s),t=this.decompress(t,a);let n=new TextDecoder("utf-8");var t=n.decode(t)}catch(o){t=(t=o.stack).replace(/[\t ]{4,}/g,"	")}return(""==t||null==t)&&(t="Couldn't decode the provided link.\nCould not parse Data Parameter."),t=t.replace(/\s+$/gm,"")}push(e){let r=new TextEncoder;var t=r.encode(e);return t=this.compress(t,this.defaultCompression),t=this.encode(t,this.defaultEncoding),this.setURL(t,this.defaultCompression,this.defaultEncoding),null}setURL(e,r,t){var a=window.location.href.split("?")[0],s=a+"?enc="+t+"&cmpr="+r+"&data="+e;window.link_full=s,s.length+512>this.maxURILength&&(s=a+"?enc="+t+"&cmpr="+r+"&data=MAXIMUM-LINK-LENGTH-EXCEEDED",this.alertNoSpam()),history.replaceState({},"",s)}getURL(){var e=/(?:data=)([^\&\=\?]*)/gm.exec(window.location.href);e=null==e||""==e[1]?"":e[1];var r=/(?:cmpr=)([^\&\=\?]*)/gm.exec(window.location.href);r=null==r||""==r[1]?"ZLIB":r[1];var t=/(?:enc=)([^\&\=\?]*)/gm.exec(window.location.href);t=null==t||""==t[1]?"URI-B64":t[1];var a={};return a.encoding=t,a.compressor=r,a.data=e,a}encode(e,r){return"URI-B64"===r?function e(r){var t="";for(var a of r)t+=String.fromCodePoint(a);var s=btoa(t);return s.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}(e):(console.warn("unrecognized encoding argument: "+r),null)}decode(e,r){return"URI-B64"===r?function e(r){var t=atob(r=r.replace(/\-/g,"+").replace(/\_/g,"/")),a=[];for(var s of t)a.push(s.charCodeAt(0));return new Uint8Array(a)}(e):(console.warn("unrecognized encoding argument: "+r),null)}decompress(e,r){switch(r){case"ZLIB":return function e(r){try{r=pako.inflate(r)}catch(t){r="There was a problem decoding the data in the link.\nAre you sure it was produced by this program?\nError has been printed to console.",console.error(t)}return r}(e);case"LZMA2":return function e(r){var t=[];for(var a of r)t.push(a-128);var r=LZMA.decompress(t),s=[];for(var a of r)s.push(a+128);return s=new Uint8Array(s),console.debug(s),s}(e);default:return console.warn("unrecognized decompression argument: "+r),null}}compress(e,r){switch(r){case"ZLIB":var t;return t=e,t=pako.deflate(t,{level:9});case"LZMA2":return function e(r){var t=[];for(var a of r)t.push(a-128);r=LZMA.compress(t,9);var s=[];for(var a of r)s.push(a+128);return new Uint8Array(s)}(e);default:return console.warn("unrecognized compression argument: "+r),null}}}