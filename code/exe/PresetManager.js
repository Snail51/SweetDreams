// MINIFIED VERSION OF THE FILE OF THE SAME NAME IN THE `src` FOLDER
// MINIFIED WITH https://www.toptal.com/developers/javascript-minifier 

export class Loader{constructor(){this.activeList=[],this.compressor=new URIManager}async load(){this.activeList=this.compressor.pull().split(","),document.getElementById("printout_loadparams").innerHTML=this.activeList.join("\n");var e=window.audioNodes;for(var t of e)if(this.activeList.some(e=>e.startsWith(t.src))){await t.play();var r=this.activeList.find(e=>e.startsWith(t.src));for(var a of(await t.adjustVolume(r.split(";")[1]),t.elements))a.querySelectorAll(".SLIDER")[0].value=100*Math.cbrt(parseFloat(r.split(";")[1])/2)}}}export class Saver{constructor(){this.activeList=[],this.compressor=new URIManager,this.oldDigest=""}async save(){this.activeList=[];var e=window.audioNodes;for(var t of e)t.playing&&this.activeList.push(t.src+";"+t.volume);var r=this.activeList.join(",");let a=new TextEncoder;var s=await crypto.subtle.digest("SHA-256",a.encode(r));s!=this.oldDigest&&(this.compressor.push(r),this.oldDigest=s,console.debug(this))}}export class URIManager{constructor(){this.maxURILength=8192,this.defaultCompression="LZMA2",this.defaultEncoding="URI-B64",this.lastAlert=new Date(0)}alertNoSpam(){new Date().getTime()-this.lastAlert>=3e4&&alert("Maxium URL Length Reached!\n\nShorten your document or prepare to save the raw text content!"),this.lastAlert=new Date().getTime()}pull(e){var t=this.getURL(e),r=t.data;if(window.location.href.endsWith("program.html.php")||window.location.href.endsWith("program.html"))return"";if(""==r)return"Error\n	No data parameter provided";var a=t.compressor,s=t.encoding;try{r=this.decode(r,s),r=this.decompress(r,a);let n=new TextDecoder("utf-8");var r=n.decode(r)}catch(o){r=(r=o.stack).replace(/[\t ]{4,}/g,"	")}return(""==r||null==r)&&(r="Couldn't decode the provided link.\nCould not parse Data Parameter."),r=r.replace(/\s+$/gm,"")}push(e){let t=new TextEncoder;var r=t.encode(e);return r=this.compress(r,this.defaultCompression),r=this.encode(r,this.defaultEncoding),this.setURL(r,this.defaultCompression,this.defaultEncoding),null}setURL(e,t,r){var a=window.location.href.split("?")[0],s=a+"?enc="+r+"&cmpr="+t+"&data="+e;window.link_full=s,s.length+512>this.maxURILength&&(s=a+"?enc="+r+"&cmpr="+t+"&data=MAXIMUM-LINK-LENGTH-EXCEEDED",this.alertNoSpam()),history.replaceState({},"",s)}getURL(){var e=/(?:data=)([^\&\=\?]*)/gm.exec(window.location.href);e=null==e||""==e[1]?"":e[1];var t=/(?:cmpr=)([^\&\=\?]*)/gm.exec(window.location.href);t=null==t||""==t[1]?"ZLIB":t[1];var r=/(?:enc=)([^\&\=\?]*)/gm.exec(window.location.href);r=null==r||""==r[1]?"URI-B64":r[1];var a={};return a.encoding=r,a.compressor=t,a.data=e,a}encode(e,t){return"URI-B64"===t?function e(t){var r="";for(var a of t)r+=String.fromCodePoint(a);var s=btoa(r);return s.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}(e):(console.warn("unrecognized encoding argument: "+t),null)}decode(e,t){return"URI-B64"===t?function e(t){var r=atob(t=t.replace(/\-/g,"+").replace(/\_/g,"/")),a=[];for(var s of r)a.push(s.charCodeAt(0));return new Uint8Array(a)}(e):(console.warn("unrecognized encoding argument: "+t),null)}decompress(e,t){switch(t){case"ZLIB":return function e(t){try{t=pako.inflate(t)}catch(r){t="There was a problem decoding the data in the link.\nAre you sure it was produced by this program?\nError has been printed to console.",console.error(r)}return t}(e);case"LZMA2":return function e(t){var r=[];for(var a of t)r.push(a-128);var t=LZMA.decompress(r),s=[];for(var a of t)s.push(a+128);return s=new Uint8Array(s),console.debug(s),s}(e);default:return console.warn("unrecognized decompression argument: "+t),null}}compress(e,t){switch(t){case"ZLIB":var r;return r=e,r=pako.deflate(r,{level:9});case"LZMA2":return function e(t){var r=[];for(var a of t)r.push(a-128);t=LZMA.compress(r,9);var s=[];for(var a of t)s.push(a+128);return new Uint8Array(s)}(e);default:return console.warn("unrecognized compression argument: "+t),null}}}