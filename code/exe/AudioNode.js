// MINIFIED VERSION OF THE FILE OF THE SAME NAME IN THE `src` FOLDER
// MINIFIED WITH https://www.toptal.com/developers/javascript-minifier 

export class AudioNode{constructor(t,s,i){this.audioCtx=s,this.elements=[],this.elements.push(i),this.playing=!1,this.volume=.25,this.loaded=0,this.error=!1,this.src=t,this.data=new ArrayBuffer,this.source,this.noise,window.addEventListener("beforeunload",()=>this.shutdown())}async load(){for(var t of(this.loaded=1,this.elements))t.style.backgroundColor="#8800cc";let s=await fetch(this.src);if(console.log(s),!s.ok){t.style.backgroundColor="#ff0000",this.error=!0;return}let i=await s.arrayBuffer();this.loaded=2,this.data=await this.audioCtx.decodeAudioData(i),this.source=await this.audioCtx.createBufferSource(),this.source.buffer=this.data,this.source.loop=!0,this.loaded=3,this.noise=await this.audioCtx.createGain(),this.noise.gain.setValueAtTime(this.volume,this.audioCtx.currentTime),await this.source.connect(this.noise),await this.noise.connect(this.audioCtx.destination),this.loaded=4,await this.source.start(),await this.noise.disconnect(),this.loaded=5,console.debug(`${this.src} - Finished loading data for AudioNode`)}async play(){if(0==this.loaded&&await this.load(),5==this.loaded){for(var t of this.elements)t.style.backgroundColor="#999999";await this.noise.connect(this.audioCtx.destination),this.playing=!0,console.debug(`${this.src} - Started Playback of AudioNode`)}}async stop(){if(0==this.loaded&&await this.load(),5==this.loaded){for(var t of this.elements)t.style.backgroundColor="#555555";this.noise.disconnect(),this.playing=!1,console.debug(`${this.src} - Halted Playback of AudioNode`)}}async toggle(){!1==this.playing?await this.play():await this.stop(),window.URIsaver.save()}async adjustVolume(t,s){if(this.volume=t,this.noise.gain.setValueAtTime(this.volume,this.audioCtx.currentTime),s)for(var i of this.elements)i.querySelectorAll(".SLIDER")[0].value=s;else for(var i of this.elements)i.querySelectorAll(".SLIDER")[0].value=100*Math.cbrt(t)}async shutdown(){if(this.loaded>0){try{this.source.stop()}catch(t){console.error(t)}try{this.noise.disconnect()}catch(s){console.error(s)}try{this.source.disconnect()}catch(i){console.error(i)}console.debug(`${this.src} - Shutdown AudioNode`)}}async addPointer(t){this.elements.push(t)}}