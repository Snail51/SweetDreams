// MINIFIED VERSION OF THE FILE OF THE SAME NAME IN THE `src` FOLDER
// MINIFIED WITH https://www.toptal.com/developers/javascript-minifier
// MINIFIED AT Thu May 29 20:31:50 CDT 2025

export class AudioNode{constructor(e,t,s){this.audioCtx=t,this.elements=[],this.elements.push(s),this.playing=!1,this.volume=.25,this.loaded=0,this.error=!1,this.src=e,this.data=new ArrayBuffer,this.source,this.noise,window.addEventListener("beforeunload",()=>this.shutdown())}async load(){for(var e of(this.loaded=1,this.elements))e.style.backgroundColor="#8800cc";var t,s=document.createElement("audio"),o=""!=s.canPlayType("audio/ogg")?s.canPlayType("audio/ogg"):"no";async function i(e){try{let t=await fetch(e,{method:"HEAD",cache:"no-store"});return t.ok}catch(s){return console.error("Error checking file:",s),!1}}if(s.remove(),"no"==o&&(this.src=this.src.replace(/\.ogg$/gm,".mp3")),!await i(this.src)){for(var e of(this.error=!0,console.error(`Error loading ${this.src}`),this.elements))e.style.backgroundColor="#ff0000";return}var a=this.elements[0].querySelectorAll(".SLIDER")[0].value;for(var e of this.elements)e.querySelectorAll(".SLIDER")[0].classList.add("LOCKED");var r=new XMLHttpRequest;r.open("GET",this.src,!0),r.responseType="arraybuffer",r.onload=function(e){t=this.response},r.onprogress=e=>{for(var t of this.elements)t.querySelectorAll(".SLIDER")[0].value=e.loaded/e.total*100},r.onloadend=e=>{console.debug("ArrayBuffer loaded successfully:",t)},r.send(),await new Promise(e=>{console.log(r),r.onloadend=()=>e()});let l=t;for(let n of this.elements)n.querySelectorAll(".SLIDER")[0].value=a,n.querySelectorAll(".SLIDER")[0].classList.remove("LOCKED");this.loaded=2,this.data=await this.audioCtx.decodeAudioData(l),this.source=await this.audioCtx.createBufferSource(),this.source.buffer=this.data,this.source.loop=!0,this.loaded=3,this.noise=await this.audioCtx.createGain(),this.noise.gain.setValueAtTime(this.volume,this.audioCtx.currentTime),await this.source.connect(this.noise),await this.noise.connect(this.audioCtx.destination),this.loaded=4,await this.source.start(),await this.noise.disconnect(),this.loaded=5,console.debug(`${this.src} - Finished loading data for AudioNode`)}async play(){if(0==this.loaded&&await this.load(),5==this.loaded){for(var e of this.elements)e.style.backgroundColor="#999999";await this.noise.connect(window.amplifier),this.playing=!0,console.debug(`${this.src} - Started Playback of AudioNode`)}}async stop(){if(0==this.loaded&&await this.load(),5==this.loaded){for(var e of this.elements)e.style.backgroundColor="#555555";this.noise.disconnect(),this.playing=!1,console.debug(`${this.src} - Halted Playback of AudioNode`)}}async toggle(){!1==this.playing?await this.play():await this.stop(),window.URIsaver.save()}async adjustVolume(e,t){if(this.volume=e,this.noise.gain.setValueAtTime(this.volume,this.audioCtx.currentTime),t)for(var s of this.elements)s.querySelectorAll(".SLIDER")[0].value=t;else for(var s of this.elements)s.querySelectorAll(".SLIDER")[0].value=100*Math.cbrt(e)}async shutdown(){if(this.loaded>0){try{this.source.stop()}catch(e){console.error(e)}try{this.noise.disconnect()}catch(t){console.error(t)}try{this.source.disconnect()}catch(s){console.error(s)}console.debug(`${this.src} - Shutdown AudioNode`)}}async addPointer(e){this.elements.push(e)}}