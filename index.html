<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>Sweet Dreams</title>
        <link rel="icon" href="./Resources/js_icon.jpg" type="jpg">

        <!-- Consumes custom <AudioNode> elements and initializes all their logic and DOM elements -->
        <script type="module">
            import { AudioNode } from "./audionode.js";
            window.audioCTX = new window.AudioContext();
            window.audioNodes = new Array();

            var audioNodeDOMs = document.querySelectorAll("AudioNode");
            for( var node of audioNodeDOMs )
            {
                // capture DOM element attributes
                const name = node.getAttribute("name");
                const src = node.getAttribute("src");

                // create new div object
                var newDiv = document.createElement("div");
                newDiv.className = "audioContainer";

                // create new AudioNode object
                var newNode = new AudioNode(src, window.audioCTX, newDiv);
                window.audioNodes.push(newNode);
                const nodeIndex = window.audioNodes.length-1;

                // create new button object
                var newButton = document.createElement("button");
                newButton.innerHTML = name;
                newButton.addEventListener("click", () => window.audioNodes[nodeIndex].toggle());

                // create new <input> of type `range`
                var newRange = document.createElement("input");
                newRange.type = "range";
                newRange.addEventListener("input", () => window.audioNodes[nodeIndex].adjustVolume(event.target.value/100));

                // insert the elements into the div
                newDiv.appendChild(newButton);
                newDiv.appendChild(newRange);

                // place the new div structure onto the DOM
                node.insertAdjacentElement("afterend", newDiv);

                // remove placeholder node of type <AudioNode>
                node.remove();
            }
        </script>

        <style>
            .audioContainer {
                width: 20vmin;
                height: 20vmin;
                display: flex;
                flex-direction: column;
                padding: 1%;

                background-color: #555555;
            }
            .audioContainer > :nth-child(1) {
                flex: 4;
                font-size: 1.5vmax;
            }
            .audioContainer > :nth-child(2) {
                flex: 1;
            }

            .mainGrid {
                width: 90vw;
                display: grid;
                grid-template-columns: repeat(auto-fit, 20vmin);
                row-gap: 1%;
                column-gap: 1%;
            }
        </style>
    </head>
    <body style="background-color: rgb(44, 46, 54); color: whitesmoke; font-size: 24px;">

        <h2>Brendan</h2>
        <div class="mainGrid">
            <AudioNode src="./audiosrc/Stream-B.wav" name="Stream"></AudioNode>
            <AudioNode src="./audiosrc/Heartbeat-B.wav" name="Heartbeat"></AudioNode>
            <AudioNode src="./audiosrc/Ocean_Waves-B.wav" name="Ocean Waves"></AudioNode>
            <AudioNode src="./audiosrc/Summer_Night-B.wav" name="Summer Night"></AudioNode>
            <AudioNode src="./audiosrc/Tropical_Forest-B.wav" name="Tropical Forest"></AudioNode>
            <AudioNode src="./audiosrc/White_Noise-B.wav" name="White Noise"></AudioNode>
        </div><br>

        <hr>

        <h2>Gloria</h2>
        <div class="mainGrid">
            <AudioNode src="./audiosrc/Bird-G.mp3" name="Bird"></AudioNode>
            <AudioNode src="./audiosrc/Bouy-G.mp3" name="Bouy"></AudioNode>
            <AudioNode src="./audiosrc/Brook-G.mp3" name="Brook"></AudioNode>
            <AudioNode src="./audiosrc/Ocean-G.mp3" name="Ocean"></AudioNode>
            <AudioNode src="./audiosrc/Rain-G.mp3" name="Rain"></AudioNode>
            <AudioNode src="./audiosrc/Seagull-G.mp3" name="Seagull"></AudioNode>
            <AudioNode src="./audiosrc/Summer_Night-G.mp3" name="Summer Night"></AudioNode>
            <AudioNode src="./audiosrc/Thunder-G.mp3" name="Thunder"></AudioNode>
            <AudioNode src="./audiosrc/Wind-G.mp3" name="Wind"></AudioNode>
            <AudioNode src="./audiosrc/Womb-G.mp3" name="Womb"></AudioNode>
            
        </div><br>

        <hr>

        <h2>Forest</h2>
        <div class="mainGrid">
            <AudioNode src="./audiosrc/atmos/forest_birds.ogg" name="Birds"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_campfire.ogg" name="Campfire"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_crickets.ogg" name="Crickets"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_frogs.ogg" name="Frogs"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_owl.ogg" name="Owl"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_rain.ogg" name="Rain"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_rainontent.ogg" name="Rain on Tent"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_river.ogg" name="River"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_storm.ogg" name="Storm"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_tawnyowl.ogg" name="Tawny Owl"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_waterfall.ogg" name="Waterfall"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_wind.ogg" name="Wind"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_wolf.ogg" name="Wolf"></AudioNode>
            <AudioNode src="./audiosrc/atmos/forest_woodpecker.ogg" name="Woodpecker"></AudioNode>
        </div><br>

        <hr>
        
        <h2>DEBUG</h2>
        <div class="mainGrid">
            <AudioNode src="./audiosrc/OVERLAP.mp3" name="DEBUG"></AudioNode>
        </div><br>
        
    </body>
</html>
